<div class="product-form-container">
  <h2>Registrar/Actualizar Producto</h2>
  <form (ngSubmit)="onSubmit()">

    <mat-form-field appearance="fill">
      <mat-label>Código de Barras</mat-label>
      <input matInput type="text" [(ngModel)]="product.barcode" name="barcode" (input)="onBarcodeChange()">
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Cantidad (Entrada)</mat-label>
      <input matInput type="number" [(ngModel)]="quantity" name="quantity" required min="0">
    </mat-form-field>

    <mat-form-field appearance="fill" *ngIf="currentProductStock !== null">
      <mat-label>Stock Actual</mat-label>
      <input matInput type="number" [ngModel]="currentProductStock" name="currentProductStock" readonly>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Nombre del Producto</mat-label>
      <input matInput type="text" [(ngModel)]="product.name" name="name" required>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Descripción</mat-label>
      <textarea matInput [(ngModel)]="product.description" name="description"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Precio de Venta</mat-label>
      <input matInput type="number" [(ngModel)]="product.salePrice" name="salePrice" required min="0">
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Precio de Compra</mat-label>
      <input matInput type="number" [(ngModel)]="product.purchasePrice" name="purchasePrice" required min="0">
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Stock Mínimo</mat-label>
      <input matInput type="number" [(ngModel)]="product.minStock" name="minStock" min="0">
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Unidad de Medida</mat-label>
      <input matInput type="text" [(ngModel)]="product.unitOfMeasure" name="unitOfMeasure">
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Categoría</mat-label>
      <mat-select [(ngModel)]="product.categoryId" name="categoryId" required>
        <mat-option *ngFor="let category of categories" [value]="category.id">
          {{ category.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Proveedor</mat-label>
      <mat-select [(ngModel)]="product.supplierId" name="supplierId" required>
        <mat-option *ngFor="let supplier of suppliers" [value]="supplier.id">
          {{ supplier.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-checkbox [(ngModel)]="product.isActive" name="isActive">Producto Activo</mat-checkbox>

    <div class="file-input-container">
      <input type="file" (change)="onFileSelected($event)" accept="image/*">
      <span *ngIf="selectedImageFile">{{ selectedImageFile.name }}</span>
    </div>

    <button mat-raised-button color="primary" type="submit">Registrar/Actualizar Producto</button>
  </form>
</div>